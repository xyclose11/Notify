@model IEnumerable<NoteApp.Models.Note>

<h1>Notes</h1>
<div class="container-fluid">
        <div class="row badge bg-secondary">
                <a class="font-monospace text-white text-decoration-none text-md-center" href="@Url.Action("Create")">New Note +</a>
        </div>
</div>
                
        


<div class="container text-center">
        <div class="row justify-content-sm-center">
                @foreach (var note in Model)
                { 
                        <div class="card m-2 p-0" style="width: 12rem;">
                                <div class="card-header">
                                        <h2>@Html.DisplayFor(modelItem => note.Title)</h2>
                                        
                                </div>
                                
                                <div class="card-body">
                                        <p class="card-text">@Html.DisplayFor(modelItem => note.Body)</p>
                                </div>

                                <div class="card-footer">

                                        <div class="badge bg-secondary text-wrap">
                                                <a class="text-decoration-none text-md-center font-monospace text-white" href="@Url.Action("Edit", new { id = note.Id })">Edit</a>
                                        </div>
                                        <div class="badge bg-secondary text-wrap">
                                                <a class="text-decoration-none text-md-center font-monospace text-white" href="@Url.Action("Details", new { id = note.Id })">Details</a>
                                        </div>
                                        <div class="badge bg-secondary text-wrap">
                                                <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal">
                                                        Delete
                                                </button>
                                                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                        <div class="modal-dialog">
                                                                <div class="modal-content">
                                                                        <div class="modal-header">
                                                                                <h1 class="modal-title text-black fs-5" id="exampleModalLabel">Delete Confirmation</h1>
                                                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                                        </div>
                                                                        <div class="modal-body">
                                                                                <button type="button" class="btn btn-danger delete-note" data-note-id="@note.Id">Delete</button>
                                                                                <a class="text-decoration-none text-md-center font-monospace text-black" href="@Url.Action("Delete", new { id = note.Id })">Delete</a>
                                                                        </div>
                                                                </div>
                                                        </div>
                                                </div>
                                        </div>
                                </div>

                        </div>

                }
        </div>
</div>

<script>
        $(document).ready(function() {
                $('.delete-note').on('click', function() {
                        const noteId = $(this).data('note-id');
                        $.ajax({
                                url: '/Note/Delete/' + noteId,
                                type: 'POST',
                                headers: {
                                        'RequestVerificationToken': $('input[name="__RequestVerificationToken"]').val()
                                },
                                success: function(result) {
                                        if (result.success) {
                                                // Remove the note from the DOM
                                                $(this).closest('.card').remove();
                                        } else {
                                                // Handle error
                                                alert('Error deleting note.');
                                        }
                                }
                                
                        });
                });
        });
</script>

